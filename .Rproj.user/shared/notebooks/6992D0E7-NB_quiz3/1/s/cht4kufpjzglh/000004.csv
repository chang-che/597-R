"0","### generate multivariate normal using Cholesky decomposition ###"
"0","genmultv.chol <- function(n,mu,Sigma){"
"0","  d <- length(mu)"
"0","  Q <- chol(Sigma)"
"0","  Z <- matrix(rnorm(n*d),nrow=n)"
"0","  X <- Z%*%Q+matrix(mu, byrow = T, nrow = n, ncol = length(mu))"
"0","  return(X)"
"0","}"
"0","my.mu <- c(0,0,0)"
"0","my.Sigma <- matrix(c(2,1,1,1,2,1,1,1,2),nrow=3)"
"0","my.Xchol <- genmultv.chol(10000,my.mu,my.Sigma)"
"0","colMeans(my.Xchol)"
"1","[1]"
"1"," 0.003311144"
"1"," 0.005037190"
"1"," 0.010093608"
"1","
"
"0","##"
"0","apply(my.Xchol,2,mean)"
"1","[1]"
"1"," 0.003311144"
"1"," 0.005037190"
"1"," 0.010093608"
"1","
"
"0","cov(my.Xchol)"
"1","    "
"1","      [,1]"
"1","      [,2]"
"1","      [,3]"
"1","
[1,]"
"1"," 2.0303713"
"1"," 0.9987475"
"1"," 1.0099323"
"1","
[2,]"
"1"," 0.9987475"
"1"," 1.9774164"
"1"," 0.9929698"
"1","
[3,]"
"1"," 1.0099323"
"1"," 0.9929698"
"1"," 1.9895689"
"1","
"
